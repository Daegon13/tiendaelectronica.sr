---
import type { Product } from "../data/products";
import { formatMoney } from "../lib/format";

const { product, href } = Astro.props as { product: Product; href: (p: string) => string };
const out = product.stockQty <= 0;
---
<article class="rounded-lg border border-slate-200 p-4">
  <a href={href(`/producto/${product.slug}`)} class="block">
    <img class="h-44 w-full rounded-md object-cover" src={product.images[0]} alt={product.name} loading="lazy" />
    <div class="mt-3 flex items-start justify-between gap-3">
      <div>
        <div class="text-sm text-slate-500">{product.brand}</div>
        <div class="font-medium">{product.name}</div>
      </div>
      <div class="text-right font-semibold">{formatMoney(product.price, product.currency)}</div>
    </div>
    <div class="mt-2 text-sm text-slate-600">{product.shortDescription}</div>
  </a>

  <div class="mt-3 flex items-center justify-between">
    <span class={`text-xs px-2 py-1 rounded-full ${out ? "bg-slate-100 text-slate-600" : "bg-emerald-50 text-emerald-700"}`}>
      {out ? "Sin stock" : `Stock: ${product.stockQty}`}
    </span>
    <a class="text-sm underline" href={href(`/producto/${product.slug}`)}>Ver</a>
  </div>
</article>
